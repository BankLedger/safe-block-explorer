'use strict';

angular.module('insight.system').controller('FooterController',
    function ($scope, $route, $templateCache, gettextCatalog, amMoment, Version) {
        $scope.defaultLanguage = defaultLanguage;
        $scope.Language = defaultLanguageCode;

        var _getVersion = function () {
            Version.get({},
                function (res) {
                    $scope.version = res.version;
                });
        };

        $scope.version = _getVersion();

        $scope.availableLanguages = [{
            //     name: 'Deutsch',
            //     isoCode: 'de_DE',
            // }, {
            name: 'English',
            isoCode: 'en'
        }, {
            // name: 'Spanish',
            // isoCode: 'es',
            // }, {
            //     name: 'Chinese',
            name: '中文',
            isoCode: 'zh_CN'
            // },{
            //     name: 'Japanese',
            //     isoCode: 'ja',
        }];

        $scope.setLanguage = function (isoCode, luang) {
            gettextCatalog.currentLanguage = $scope.defaultLanguage = defaultLanguage = isoCode;
            $scope.Language = defaultLanguageCode = luang;
            amMoment.changeLocale(isoCode);
            localStorage.setItem('insight-language', isoCode);
            localStorage.setItem('insight-languageCode', luang);
            var currentPageTemplate = $route.current.templateUrl;
            $templateCache.remove(currentPageTemplate);
            $route.reload();
        };
    });
