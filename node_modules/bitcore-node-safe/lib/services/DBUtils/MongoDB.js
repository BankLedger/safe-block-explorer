"use strict";
var mongo = require('mongoskin');

function Mongodb(conf) {
    this.db = mongo.db(conf.url, conf.options, function (err) {
        console.log(" 构造函数,连接mongodb 出错...[致命错误程序终止]");
        process.exit();
    });
    this.db.bind("sealAddress");
}

Mongodb.prototype.getDepositAmountForAddress = function (address, cb) {
    var self = this;
    self.db.sealAddress.find({_id: address}).toArray(function (err, address) {
        if (err) {
            return cb(err);
        }
        if (address.length > 0) {
            cb(null, address[0].value);
        } else {
            cb(null, 0);
        }
    })
};

module.exports = Mongodb;