var excel = require("./ExcelDetail");
var count = require("./ExcelCount");
var optionArray = process.argv.splice(2);//获取控制台传入的参数
var start = optionArray[0];
var end = optionArray[1];
var opiton = {};

if(isNaN(start)){
    var startTimestamp = new Date(start).getTime() / 1000;
    if(startTimestamp.toString() == "NaN"){
        console.log("开始时间格式不正确，已使用默认条件生成excel");
        opiton.time ={
            $gt:0
        }
    }else{
        opiton.time ={
            $gt:startTimestamp
        }
    }
}else{
    console.log(start)
    opiton.height = {
        $gt:parseInt(start)
    }
}

if(isNaN(end)){
    var startTimestamp = new Date(end).getTime() / 1000;
    if(startTimestamp.toString() == "NaN"){
        console.log("结束时间格式不正确，已使用默认条件生成excel");
        if(opiton.time){
            opiton.time ={$gt:opiton.time.$gt ,$lt:9999999999}
        }else{
            opiton.time = {
                $lt : 9999999999
            }
        }
    }else{
        if(opiton.time){
            opiton.time ={$gt:opiton.time.$gt ,$lt:startTimestamp}
        }else{
            opiton.time ={
                 $lt : startTimestamp
            }
        }
    }
}else{
    if(opiton.height){
        opiton.height ={$gt:opiton.height.$gt ,$lt:parseInt(end)}
    }else{
        opiton.height = {
            $lt:parseInt(end)
        }
    }
}

var excelDetail =new excel();
var excelCount = new count();
excelDetail.generateExcelDetailFile(opiton,function(){
    console.error("Excel Detail gameergate complete");
})
excelCount.generateExcelCountFile(opiton,function () {
    console.error("Excel Count gameergate complete");
})




